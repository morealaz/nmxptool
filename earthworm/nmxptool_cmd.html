<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Earthworm Modules: nmxptool commands</title>
</head>
<body alink="#ff0000" vlink="#551a8b" link="#0000ee"
 style="color: rgb(0, 0, 0); background-color: rgb(250, 223, 175);">
<center>
<h1>Earthworm Modules: <br>
nmxptool configuration file </h1>
<i>(beta revision, last revised 10 December, 2007)</i></center>
Page Index:<br>
1. <a href="#function">Functional command listing</a><br>
2. <a href="#alphabet">Alphabetic command listing &amp; description</a><br>
3. <a href="#advanced_description">Advanced Description</a><br>
4. <a href="#sample_config">Sample Configuration File</a><br>

<p><!-- ADD HERE: Paragraph "On startup, xxxx reads the..." -->
On startup, nmxptool reads the configuration file named on the command
line. Commands in this file set all the parameters used for configuring
the Earthworm Nanometrics client module nmxptool
(<a href="http://www.nanometrics.ca/">Nanometrics</a>).
In the control file, lines may begin with a valid nmxptool command (listed below) or
with one of 2 special characters: </p>
<blockquote>
  <pre>#  marks the line as a comment (example: # This is a comment).<br>   <br>@  allows control files to be nested; one control file can be <br>   accessed from another with the command "@" followed by <br>   a string representing the path name of the next control file <br>   (example: @model.d).<br></pre>
</blockquote>
Command names must be typed in the control file exactly as shown in
this document (commands are case sensative).&nbsp; Blank lines are also
permitted in the control file.<br>
<br>

<h2><a name="function">1. FUNCTIONAL COMMAND LISTING</a></h2>
<p><!-- ADD HERE: Paragraph "Below are the commands recognized..." -->
Below are the commands recognized by nmxptool, grouped by the function
they influence. Most of the commands are required; they may be
specified in any order in the control file.
<!-- ADD HERE: The pre-formatted functional command listing      --><!-- To make an anchor for each command, surround it with these: -->
<br>
</p>
<pre>        Earthworm system setup:<br>
<a href="#MyModuleId">MyModuleId</a>              required<br>
<a href="#RingName">RingName</a>                required<br>
<a href="#HeartBeatInterval">HeartBeatInterval</a>       required<br>
<a href="#Verbosity">Verbosity</a>		optional<br><br>

Nanometrics server and connection parameters:<br>
<a href="#NmxpHost">NmxpHost</a>                required<br>
<a href="#NmxpPortPDS">NmxpPortPDS</a>		optional<br>
<a href="#NmxpPortDAP">NmxpPortDAP</a>		optional<br>
<a href="#ForceTraceBuf1">ForceTraceBuf1</a>		optional<br>
<a href="#MaxTolerableLatency">MaxTolerableLatency</a>	optional<br>
<a href="#MaxDataToRetrieve">DataToRetrieve</a>		optional<br>
<a href="#TimeoutRecv">TimeoutRecv</a>		optional<br>
<a href="#DefaultNetworkCode">DefaultNetworkCode</a>	optional<br>
<a href="#ChannelFile">ChannelFile</a>		required	Xor Channel<br>
<a href="#Channel">Channel</a>			required	Xor ChannelFile<br>
<br>

Output control:<br>
<a href="#LogFile">LogFile</a>			required<br>
</pre>


<h2><a name="alphabet">2. ALPHABETIC COMMAND LISTING &amp; DESCRIPTION</a></h2>
<p> In the following section, all configuration file commands are
listed
in alphabetical order. Listed along with the command (bold-type) are
its arguments (in red), the name of the subroutine that processes the
command, and the function within the module that the command
influences.
A detailed description of the command and is also given. Default values
and example commands are listed after each command description. </p>

<pre><b><br>command <font color="red">arg </font>                                 processed by            in function</b></pre>

<hr><!-- ADD HERE: all commands; below is a sample command blank: --><!-- command name as anchor inside quotes -->
<pre><a name="Channel"><b>Channel <font color="red">streamkey</font>                 ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies one stream
of data to be requested from the NmxpHost.
The <font color="red">streamkey</font> is composed of a network, station and channel code
separated by period. network is optional and it is used only for output.
Station code can be &#42; that stands for all stations.
Within channel code can appear character &#63; that stands for any characters.
DO NOT USE WITH <a href="#ChannelFile">ChannelFile</a>!
  <pre><br>Default:  none<br>Example:  Channel  ES.BOB.HH?<br>          Channel  *.HHZ<br>          Channel  MN.TIR.HH?<br>          Channel  SALO.BH?</pre>
</blockquote>

<hr><!-- ADD HERE: all commands; below is a sample command blank: --><!-- command name as anchor inside quotes -->
<pre><a name="ChannelFile"><b>ChannelFile <font color="red">channel_state_file</font>                 ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies one or more streams
of data to be requested from the NmxpHost.
The <font color="red">streamkey</font> is the same for the <a href="#Channel">Channel</a>.
Allow data continuity between program restarts, within time defined by <a href="#MaxDataToRetrieve">MaxDataToRetrieve</a> and data buffered by the DataServer and NaqsServer.
This file is created by the user, nmxptool will update date and time of last sample received for each channel into the file &quot;<font color="red">channel_state_file</font>.nmxpstate&quot;. DO NOT USE WITH <a href="#Channel">Channel</a>!
  <pre><br>Default:  none<br>Example:  ChannelFile  /home/ew/list_channels_naqs1.txt</br>
</br>Example of file created by the user:<br />ES.BOB.HH?<br/>MN.TIR.HHZ
</br>Example of file updated by nmxptool:<br />ES.BOB.HHE 1970.001,00:00:00.0000 2007.353,13:30:36.8700<br />ES.BOB.HHN 1970.001,00:00:00.0000 2007.353,13:30:37.4800<br />ES.BOB.HHZ 1970.001,00:00:00.0000 2007.353,13:30:37.2799<br/>MN.TIR.HHZ 1970.001,00:00:00.0000 2007.353,13:30:34.5199
</pre>
</blockquote>

<hr><!-- ADD HERE: all commands; below is a sample command blank: --><!-- command name as anchor inside quotes -->
<pre><a name="DefaultNetworkCode"><b>DefaultNetworkCode <font color="red">network_code</font>                 ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies default <font color="red">network code</font>
    for channels where is omitted.
  <pre><br>Default:  none<br>Example:  DefaultNetworkCode  IV</pre>
</blockquote>

<hr><!-- ADD HERE: all commands; below is a sample command blank: --><!-- command name as anchor inside quotes -->
<pre><a name="ForceTraceBuf1"><b>ForceTraceBuf1 <font color="red">switch</font>                        ReadConfig              Earthworm setup<br></b><!-- command args ... -->           <br></a></pre>

<blockquote><!-- command description goes here --> Sets the on-off <font
 color="red">switch</font> to force the creation of TRACEBUF messages on
systems that support TRACEBUF2 messages.  By default, the module will 
create TRACEBUF2 messages on systems that support them otherwise it will
create the older TRACEBUF messages.  This switch has no effect on systems
that do no support TRACEBUF2 messages.  This switch could be useful in 
environments where a transition is occuring between TRACEBUF and
TRACEBUF2 messages, otherwise most people will never use this.

<pre><!-- Default and example go here   --><br>Default:  0 (disabled)<br>Example:  ForceTraceBuf1 1<br></pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="HeartBeatInterval"><b>HeartBeatInterval <font color="red">interval</font>                   ReadConfig              Earthworm setup<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Defines the <font
 color="red">interval</font> in seconds at which the module will issue
TYPE_HEARTBEAT messages.
  <pre><!-- Default and example go here   --><br>Default:  none<br>Example:  HeartBeatInterval 30<br></pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="LogFile"><b>LogFile <font color="red">switch</font>                               ReadConfig              Earthworm setup<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here -->Sets the on-off
switch for writing a log file to disk. If <font color="red">switch</font>
is 0, no log file will be written. If <font color="red">switch</font>
is 1, nmxptool will write a daily log file(s) called
nmxptool.log_yymmdd where xx is nmxptool's module id (set with <a
 href="#MyModuleId">MyModuleId</a> command) and yymmdd is the current
UTC date (ex: 960123) on the system clock. The file(s) will be written
in the EW_LOG directory (environment variable).&nbsp; If <font
 color="red">switch</font> is 2 the log file is written but output to
stdout and stderr is suppressed.
  <pre><!-- Default and example go here   --><br>Default:  none<br>Example:  LogFile   1<br>  </pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="MaxDataToRetrieve"><b>MaxDataToRetrieve <font color="red">seconds</font>                                  ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Max amount of data of the past to retrieve from the DataServer when program restarts. Range is [30..86400].
  <pre><!-- Default and example go here   --><br>Default:  60<br>Example:  MaxDataToRetrieve  3600</pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="MaxTolerableLatency"><b>MaxTolerableLatency <font color="red">seconds</font>                                  ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies the max tolerable latency for raw stream connection. Range is [60..600].
  <pre><!-- Default and example go here   --><br>Default:  600<br>Example:  MaxTolerableLatency  200</pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="MyModuleId"><b>MyModuleId <font color="red">mod_id</font>                            ReadConfig              Earthworm setup<br></b><br></a></pre>
<blockquote><!-- command description goes here --> Sets the module id
for labeling all outgoing trigger, heartbeat, and error messages. <font
 color="red">mod_id</font> is a character string (valid strings are
listed in earthworm.d) that relates to a unique single-byte number.
  <pre><!-- Default and example go here   --><br>Default:  none<br>Example:  MyModuleId MOD_NMXPTOOL<br></pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="NmxpHost"><b>NmxpHost <font color="red">address</font>                               ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specify the <font
 color="red">address</font> of the Nanometrics server. This can be either
on IP address (four period-separated numbers) or the domain name of the
server.
  <pre><!-- Default and example go here   --><br>Default:  none<br>Example:  NmxpHost      naqs1a.int.ingv.it<br></pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="NmxpPortDAP"><b>NmxpPortDAP <font color="red">port</font>                                  ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies the IP <font
	color="red">port</font> number for the DataServer (<a href="#NmxpHost">NmxpHost</a>). This is
commonly 28002.
  <pre><!-- Default and example go here   --><br>Default:  28002<br>Example:  NmxpPortDAP  28002</pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="NmxpPortPDS"><b>NmxpPortPDS <font color="red">port</font>                                  ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies the IP <font
	color="red">port</font> number for the NaqsServer (<a href="#NmxpHost">NmxpHost</a>). This is
commonly 28000.
  <pre><!-- Default and example go here   --><br>Default:  28000<br>Example:  NmxpPortPDS  28000</pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="RingName"><b>RingName <font color="red">ring</font>                                ReadConfig              Earthworm setup<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Indicates which
shared memory region to use for waveform output.&nbsp; <font
 color="red">ring</font>
is a character string (valid strings are listed in earthworm.d) that
relates (in earthworm.d) to a unique number for the key to the shared
memory region.
  <pre><!-- Default and example go here   --><br>Default:  none<br>Example:  RingName WAVE_RING<br></pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="TimeoutRecv"><b>TimeoutRecv <font color="red">seconds</font>                                  ReadConfig              nmxptool parameters<br></b><!-- command args ... -->           <br></a></pre>
<blockquote><!-- command description goes here --> Specifies time-out for flushing buffered packets for each channel. Useful for Data On Demand (i.e. channel HL).  Range is [10..300].
  <pre><!-- Default and example go here   --><br>Default:  0  (No Time-out)<br>Example:  TimeoutRecv  15</pre>
</blockquote>

<hr><!-- command name as anchor inside quotes -->
<pre><a name="Verbosity"><b>Verbosity  </b></a><b><font color="red">level</font></b><b>                             ReadConfig              Earthworm setup <br></b><!-- command args ... -->           <br></pre>
<blockquote><!-- command description goes here --> Specifies the <b><font
	    color="red">level</font></b> of logging verbosity.
    Verbosity is a bitmap:<br>
    1 Packet, 2 Channel, 4 Raw Stream, 8 CRC32, 16 Connection flow, 32 Packet Management, 64 Extra, 128 Date, 256 Gap, 512 DOD, 1023 All messages.
  <pre><!-- Default and example go here   --><br>Default:  0<br>Example:  Verbosity 16</pre>
</blockquote>





<hr>
<h2><a name="advanced_description"></a>3. Advanced Description<br>
</h2>
<pre><a name="SLmode"><b>...</b></a></pre>
<blockquote> ..... .<br>
</blockquote>
<pre><a name="SLselectors"><b>.....</b></a><br></pre>
<blockquote>.....<br>
</blockquote>
<h2><a name="sample_config"></a>4. Sample Configuration File </h2>


<pre>
#
#                     Configuration File for nmxptool
#
MyModuleId           MOD_NMXPTOOL
RingName             WAVE_RING             # Transport ring to write data to.

HeartBeatInterval    15                    # Heartbeat interval, in seconds.
LogFile              1                     # 1 -> Keep log, 0 -> no log file
                                           # 2 -> write to module log but not stderr/stdout
Verbosity            16                    # Set level of verbosity. Verbosity is a bitmap:
                                           # 1 Packet, 2 Channel, 4 Raw Stream,
                                           # 8 CRC32, 16 Connection flow,
                                           # 32 Packet Management, 64 Extra, 128 Date,
                                           # 256 Gap, 512 DOD, 1023 All messages.

NmxpHost             naqs1a.int.ingv.it    # Host address of the NaqsServer server
NmxpPortPDS          28000                 # Port number of the NaqsServer server (Default 28000)
NmxpPortDAP          28002                 # Port number of the DataServer server (Default 28002)

#ForceTraceBuf1      0                      # On systems that support TRACEBUF2
                                           # messages this flag will force the module
                                           # to create TRACEBUF messages instead.
                                           # Most people will never need this.

MaxTolerableLatency  120                   # Max tolerable latency for each channel. (Default 600 sec.)
                                           # In general, do not use with parameter TimeoutRecv.

MaxDataToRetrieve    180                    # Max amount of data of the past to retrieve from the
                                           # DataServer when tool restarts (default 60) [30..86400].

#TimeoutRecv          30                    # Time-out in seconds for flushing queued data for each channel.
                                           # Useful for Data On Demand (i.e. channel HL) (Default 0. No time-out)

DefaultNetworkCode   IV                    # Default network code where in Channel is not declared

                                           # Channel is like NET.STA.CHAN
                                           # NET  is optional and used only for output.
                                           # STA  can be '*', stands for all stations.
                                           # CHAN can contain '?', stands for any character.
                                           # Example:  *.HH?,N1.STA2.??Z,STA3.?H?

ChannelFile   /home/ew/naqs1a.list.txt    # State Channel file (It will not be updated.)
                                          # Allow data continuity between program restarts
                                          # and within available data buffered on NaqsServer.
                                          # Do not use with Channel parameter below.

# Channel              ES.BOB.HH?
# Channel              MN.TIR.HH?
# Channel              MDI.HH?
# Channel              DOI.HH?
# Channel              SALO.HH?
# Channel              MONC.HH?
# Channel              *.BHZ               # Channel selection

</pre>

<hr>
<center> <a href="../modules.html">Module Index</a> | <a
 href="../ovr/nmxptool_ovr.html">nmxptool Overview</a> </center>
<!-- USGS-required stuff at the end -->
<hr>
Contact: <b>quintiliani at ingv.it</b><br>
</address>
</body>
</html>
