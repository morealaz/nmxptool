
NMXPTOOL: OPEN-SOURCE AND CROSS-PLATFORM SOFTWARE
          FOR NANOMETRICS SEISMIC DATA ACQUISITION

  Matteo Quintiliani - Istituto Nazionale di Geofisica e Vulcanologia - Italy
  Mail bug reports and suggestions to <quintiliani@ingv.it> 

  Website: http://mednet.rm.ingv.it/nmxptool.php

  nmxptool and libnmxp have been developed for interacting
  with NaqsServer and DataServer of Nanometrics Inc.


CONTENTS
   INTRODUCTION
   DEPENDENCIES
   QUICK INSTALLATION
   INSTALLATION
   DOCUMENTATION
   HISTORY
   ACKNOWLEDGEMENT
   SUPPORTED PLATFORMS
   LICENSE


- INTRODUCTION

  The Nanometrics servers NaqsServer and DataServer can provide on-line access
to seismic data and state-of-health information accepting TCP/IP connections
and forwarding the requested data to each client program.  NaqsServer collates
and stores in near-real-time incoming data in ringbuffers whereas DataServer
provides data of the past stored in NaqsServer ringbuffers.  In order to
implement the Nanometrics subscription protocols, the author developed a
software consisting of a library called libnmxp and a tool called nmxptool. The
library exposes a set of documented APIs which allow to communicate with the
Nanometrics servers. The tool, based on libnmxp, allows to retrieve or monitor
real-time data and data of the past.

  nmxptool can be used in three different ways:

      * stand-alone to monitor data or save retrieved data in mini-seed records
      * launched as an Earthworm module to redirect data into the EW-rings
      * like a Seed-Link plug-in to feed the SL-server
	
  The main contribute, as regards other similar software, is the capability to
manage Raw Stream connections by buffering and sorting all received packets,
included the retransmitted ones, guaranteeing a good compromise between data
continuity and low latency. Besides, nmxptool allows to retrieve Data-On-Demand
with minimum delay after request. Software is open-source and released under
GNU Library General Public License. It has been written in C language using the
GNU Build Tools (automake, autoconf and configure script) and taking in account
the cross-platform compilation aspects, in fact, it can run on almost all the
Unix-like operating systems, Mac OS X, Windows and either 32-bit or 64-bit
architectures.

	
- DEPENDENCIES

  Optional libraries:

    * libmseed-2.1.4 or later: http://www.iris.edu/manuals/
      The Mini-SEED library. A C library framework for manipulating and
      managing SEED data records.  Author: Chad Trabant, IRIS DMC

    * Earthworm 6.2 or later: http://www.isti2.com/ew/

    * Seedlink, SeisComP - http://www.gfz-potsdam.de/geofon/seiscomp/
      Seedlink is a system for near real time seismic data distribution.

  Read section INSTALLATION below.


- QUICK INSTALLATION

     tar xvfz nmxptool-X.X.X.tar.gz

     cd nmxptool-X.X.X
     ./configure
     make

     make install
         OR
     make install-ew-bin
     make install-ew-conf (ONLY THE FIRST TIME)
         OR
     make install-seiscomp-bin
     make install-seiscomp-templates (ONLY THE FIRST TIME)
         OR
     cp src/nmxptool <where_you_want>

     nmxptool --help


- INSTALLATION

  nmxptool and libnmxp have been developed using GNU Build Tools
  (automake, autoconf and configure script) taking in account the
  POSIX Cross-Platform aspects. So you should be able to compile
  and install them everywhere you can launch the following commands:

     ./configure
     make
     make install

  Disabling optional Packages:
      --without-libmseed      disable support for libmseed
      --without-ew            disable support for earthworm
      --without-seedlink      disable support for seedlink

  Verifying the version and supports after compilation:

     src/nmxptool -V

     nmxptool 1.2.1, Nanometrics tool
             (Private Data Stream 1.4, Data Access Protocol 1.0)
              Support for: libmseed YES, SeedLink YES, Earthworm YES.

  * libmseed, The Mini-SEED library - http://www.iris.edu/manuals/
         If available within includes and libraries path,
         this library allows to save retrieved data in Mini-SEED records.
         You might add to CFLAGS this "-I/<anywhere>/libmseed"
         and to LDFLAGS this "-L/<anywhere>/libmseed",
         do not forget to run 'ranlib libmseed.a' or similars.

  * ew, Earthworm System - http://www.isti2.com/ew/
         nmxptool is included into the official Earthworm distributions since version 7.2.
         Anyway, you can compile nmxptool outside the EW distribution, for example, to upgrade.
         Before launching 'configure', run the appropriate script from directory 'environment',
         the compilation depends on the following environment variables:
             $EW_HOME, $EW_VERSION, $EW_PARAMS and $GLOBALFLAGS.
         'configure' looks for necessary Earthworm object files inside $EW_HOME/$EW_VERSION/lib
         and link them to nmxptool in order to enable Earthworm support.
         If some of object files are missing then it will attempt to discover sources
         dependents on your operating system and it will compile them before linking.

         Install binary and configuration files for Earthworm:

             make install-ew-bin
             make install-ew-conf (ONLY THE FIRST TIME)

         The first command copies nmxptool binary in $EW_HOME/$EW_VERSION/bin
         The second command copies earthworm/nmxptool.d, earthworm/nmxptool.desc in $EW_PARAMS
         If you are upgrading nmxptool then you might do that:

             make install-ew-doc

         Last command copies nmxptool_ovr.html and nmxptool_cmd.html into the directories
	 $EW_HOME/$EW_VERSION/ewdoc/WEB_DOC/ovr and $EW_HOME/$EW_VERSION/ewdoc/WEB_DOC/cmd

  * seedlink, SeisComP - http://www.gfz-potsdam.de/geofon/seiscomp/
         Seedlink is a system for near real time seismic data distribution.
         Inside the directory 'src' has been copied files
         'seedlink_plugin.c' and 'seedlink_plugin.h' from 'plugin.c' and 'plugin.h'
         belonging to the SeisComP 2.5 distribution.

         If your SeisComP root directory is not equal to /home/sysop/seiscomp,
         you have to launch the script 'configure' in the following way:

             ./configure ... ... SEISCOMPDIR=/<where>/<seiscompdir>/<is>

         Install binary and template files for SeedLink:

             make install-seiscomp-bin
             make install-seiscomp-templates (ONLY THE FIRST TIME)

         The first command copies nmxptool binary in %SEISCOMPDIR%/acquisition/bin
         The second command copies the directory seiscomp_templates/135_nmxptool
         in %SEISCOMPDIR%/acquisition/templates/source/

         After, you can use:

             seiscomp config


- DOCUMENTATION
    * Print nmxptool help:
         # nmxptool --help
    * Earthworm module: earthworm/nmxptool_cmd.html
                                  nmxptool_ovr.html

- HISTORY
    Read file HISTORY for release notes.


- ACKNOWLEDGEMENT
   In no particular order:
     * Salvatore Mazza - I.N.G.V. (Istituto Nazionale di Geofisica e Vulcanologia)
     * Marco Olivieri - I.N.G.V.
     * Luigi Falco - I.N.G.V.
     * Martina Demartin - I.N.G.V.
     * Paul Frieberg - ISTI (Instrumental Software Technologies, Inc.)
     * Marian Jusko


- SUPPORTED PLATFORMS
   nmxptool has been written in C language using the GNU Build Tools
   (automake, autoconf and configure script) and taking in account
   the cross-platform compilation aspects, in fact, it can run on
   almost all the Unix-like operating systems, Mac OS X, Windows
   and either 32-bit or 64-bit architectures.
     

- LICENSE
  Software is open-source and released under GNU Library General Public License.
  Read file COPYING for details.

